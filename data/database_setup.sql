-- Database setup
BEGIN;

CREATE DATABASE IF NOT EXISTS BOOKCLUB;

USE BOOKCLUB;

DROP TABLE IF EXISTS TVShows;
DROP TABLE IF EXISTS Games;
DROP TABLE IF EXISTS Books;
DROP TABLE IF EXISTS Films;
DROP TABLE IF EXISTS Users;
DROP TABLE IF EXISTS Consoles;
DROP TABLE IF EXISTS Streaming_Platforms;

CREATE TABLE Users (Users_ID INT(3) AUTO_INCREMENT NOT NULL PRIMARY KEY, Users_Name VARCHAR(50) UNIQUE NOT NULL, Users_Email VARCHAR(300) UNIQUE NOT NULL, Users_Password VARCHAR(50) NOT NULL);
CREATE TABLE Consoles (Consoles_ID INT(3) AUTO_INCREMENT NOT NULL PRIMARY KEY, Consoles_Name VARCHAR(50) UNIQUE NOT NULL);
CREATE TABLE Streaming_Platforms (Streaming_Platforms_ID INT(3) AUTO_INCREMENT NOT NULL PRIMARY KEY, Streaming_Platforms_Name VARCHAR(50) UNIQUE NOT NULL);
CREATE TABLE TVShows (TVShows_ID INT(3) AUTO_INCREMENT NOT NULL PRIMARY KEY, TVShows_Name VARCHAR(50) UNIQUE NOT NULL, TVShows_Finished INT(1) DEFAULT 0, Users_ID INT(3), Streaming_Platforms_ID INT(3), FOREIGN KEY(Users_ID) REFERENCES Users (Users_ID) ON DELETE CASCADE, FOREIGN KEY(Streaming_Platforms_ID) REFERENCES Streaming_Platforms (Streaming_Platforms_ID) ON DELETE CASCADE);
CREATE TABLE Games (Games_ID INT(3) AUTO_INCREMENT NOT NULL PRIMARY KEY, Games_Name VARCHAR(50) UNIQUE NOT NULL, Games_Finished INT(1) DEFAULT 0, Users_ID INT(3), Consoles_ID INT(3), FOREIGN KEY(Users_ID) REFERENCES Users (Users_ID) ON DELETE CASCADE, FOREIGN KEY(Consoles_ID) REFERENCES Consoles (Consoles_ID) ON DELETE CASCADE);
CREATE TABLE Books (Books_ID INT(3) AUTO_INCREMENT NOT NULL PRIMARY KEY, Books_Name VARCHAR(50) UNIQUE NOT NULL, Books_Finished INT(1) DEFAULT 0, Users_ID INT(3), FOREIGN KEY(Users_ID) REFERENCES Users (Users_ID) ON DELETE CASCADE);
CREATE TABLE Films (Films_ID INT(3) AUTO_INCREMENT NOT NULL PRIMARY KEY, Films_Name VARCHAR(50) UNIQUE NOT NULL, Films_Finished INT(1) DEFAULT 0, Users_ID INT(3), Streaming_Platforms_ID INT(3), FOREIGN KEY(Users_ID) REFERENCES Users (Users_ID) ON DELETE CASCADE, FOREIGN KEY(Streaming_Platforms_ID) REFERENCES Streaming_Platforms (Streaming_Platforms_ID) ON DELETE CASCADE);

INSERT INTO Consoles (Consoles_Name) VALUES ("PS4"),("Xbox One"),("Nintendo Switch"),("PC");
INSERT INTO Streaming_Platforms (Streaming_Platforms_Name) VALUES ("Disney+"),("Sky/Now TV"),("Amazon Prime Video"),("Netflix"),("BBC iPlayer"), ("All4"),("ITV Hub"),("Other");


-- INSERT INTO Consoles VALUES ((SELECT Film_ID from Films WHERE Film_Name='Star Wars: The Force Awakens'), (SELECT Actor_ID from Actors WHERE Actor_Name='Harrison Ford'));


COMMIT;